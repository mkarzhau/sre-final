global:
  resolve_timeout: 1m

route:
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 5m
  repeat_interval: 1h
  receiver: 'default-receiver'

  routes:
    # üõë –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –û–ë–û–ò–ú
    - match:
        severity: 'critical'
      receiver: 'both-admins'

    # ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–∞–π—Ç–æ–º ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    - match_re:
        alertname: 'WebsiteDown|LoginFailure|HTTP5xx'
      receiver: 'main-admin'

    # üîß –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏ ‚Äî –≤—Ç–æ—Ä–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    - match_re:
        alertname: 'HighCPU|HighMemory|DiskFull'
      receiver: 'second-admin'
    - match_re:
        alertname: 'HighCPU|HighMemory|DiskFull|MongoConnectionsHigh'
      receiver: 'second-admin'
    - match_re:
        alertname: 'HighRequestRate|WebsiteDown|LoginFailure|HTTP5xx'
      receiver: 'main-admin'


receivers:
  - name: 'main-admin'
    telegram_configs:
      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 1044841557
        parse_mode: 'Markdown'
        message: |
          ‚ö†Ô∏è *–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–∞–π—Ç–æ–º –∏–ª–∏ –ª–æ–≥–∏–Ω–æ–º*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}

  - name: 'second-admin'
    telegram_configs:
      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 965417533
        parse_mode: 'Markdown'
        message: |
          üîß *–ù–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ —Ä–µ—Å—É—Ä—Å—ã*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}

  - name: 'both-admins'
    telegram_configs:
      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 1044841557
        parse_mode: 'Markdown'
        message: |
          üõë *CRITICAL ALERT!*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}

      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 965417533
        parse_mode: 'Markdown'
        message: |
          üõë *CRITICAL ALERT!*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}

  - name: 'default-receiver'
    telegram_configs:
      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 1044841557
        parse_mode: 'Markdown'
        message: |
          üìå *Default Alert*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}
      

      - bot_token: '7902458952:AAFfbNdAPjMTdaN6QjeLI9pJE1q7GLWZYJM'
        chat_id: 965417533
        parse_mode: 'Markdown'
        message: |
          üìå *Default Alert*
          *Alert:* {{ .CommonLabels.alertname }}
          *Instance:* {{ .CommonLabels.instance }}
          *–û–ø–∏—Å–∞–Ω–∏–µ:* {{ .CommonAnnotations.description }}
